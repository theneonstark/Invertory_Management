import{r as m,j as e,y as a}from"./app-By9T3_hT.js";import{u as A,F as L}from"./index.esm-CfDLc69O.js";import{L as _}from"./Layout-B2cxh-r7.js";import{t as D,Q as I,T as P,V as B}from"./navbar-CwT8qYnT.js";import{T as k,a as z,b as w,c as n,d as H,e as c}from"./table-M1DGgy18.js";import{I as h,B as x}from"./index-BnX6mjkZ.js";import{C as R}from"./card-CSknuUnI.js";import{F as u,a as p,b as j,c as f,d as b}from"./form-D4nV-YtK.js";import{P as V,T as $}from"./trash-BRhYlp0f.js";import"./label-CFASl-Vv.js";function M(){const[y,E]=m.useState([]),[t,N]=m.useState(null),S=A(),{control:l,handleSubmit:F,formState:{errors:o},reset:v,setValue:i}=S,d=async()=>{try{const s=await D();E(s)}catch(s){console.error("Error fetching shops:",s),a.error("Failed to fetch shops")}};m.useEffect(()=>{d()},[]);const T=s=>{N(s),i("name",s.name),i("location",s.address),i("contact_number",s.contact_number)},C=async s=>{try{const r=await B(s);r.message?(a.success(`${r.message}`),d()):a.error("Failed to delete shop")}catch(r){console.error("Error deleting shop:",r),a.error("Failed to delete shop")}},q=async s=>{var r;try{t?(await I(t.id,s),a.success("Shop updated successfully!")):(await P(s),a.success("Shop added successfully!")),N(null),d(),v({name:"",location:"",contact_number:""})}catch(g){console.error("Error adding/editing shop:",((r=g.response)==null?void 0:r.data)||g.message),a.error("Failed to add/edit shop")}};return e.jsx(_,{children:e.jsxs("div",{className:"p-6 flex flex-col items-center w-full",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Shops"}),e.jsx("div",{className:"max-w-2xl p-6 md:p-8 w-full mx-auto",children:e.jsxs(R,{className:"p-8 shadow-lg rounded-lg bg-white",children:[e.jsx("h3",{className:"text-2xl font-semibold mb-4 text-gray-800",children:t?"Edit Shop":"Add New Shop"}),e.jsx(L,{...S,children:e.jsxs("form",{className:"space-y-4",onSubmit:F(q),children:[e.jsx(u,{control:l,name:"name",rules:{required:"Shop Name is required"},render:({field:s})=>{var r;return e.jsxs(p,{children:[e.jsx(j,{children:"Shop Name"}),e.jsx(f,{children:e.jsx(h,{...s,placeholder:"Enter shop name"})}),e.jsx(b,{children:(r=o.name)==null?void 0:r.message})]})}}),e.jsx(u,{control:l,name:"location",rules:{required:"Location is required"},render:({field:s})=>{var r;return e.jsxs(p,{children:[e.jsx(j,{children:"Location"}),e.jsx(f,{children:e.jsx(h,{...s,placeholder:"Enter location"})}),e.jsx(b,{children:(r=o.location)==null?void 0:r.message})]})}}),e.jsx(u,{control:l,name:"contact_number",rules:{required:"Contact Number is required",pattern:{value:/^[0-9]{10}$/,message:"Enter a valid 10-digit number"}},render:({field:s})=>{var r;return e.jsxs(p,{children:[e.jsx(j,{children:"Contact Number"}),e.jsx(f,{children:e.jsx(h,{...s,placeholder:"Enter contact number"})}),e.jsx(b,{children:(r=o.contact_number)==null?void 0:r.message})]})}}),e.jsx(x,{type:"submit",className:"w-full sm:w-auto bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-md transition",children:t?"Update Shop":"Add Shop"})]})})]})}),e.jsx("div",{className:"mt-6 w-full flex justify-center",children:e.jsx("div",{className:"w-full max-w-4xl",children:e.jsxs(k,{className:"w-full",children:[e.jsx(z,{children:e.jsxs(w,{children:[e.jsx(n,{className:"text-center",children:"ID"}),e.jsx(n,{className:"text-center",children:"Shop Name"}),e.jsx(n,{className:"text-center",children:"Address"}),e.jsx(n,{className:"text-center",children:"Actions"})]})}),e.jsx(H,{children:y.map(s=>e.jsxs(w,{children:[e.jsx(c,{className:"text-center",children:s.id}),e.jsx(c,{className:"text-center",children:s.name}),e.jsx(c,{className:"text-center",children:s.location}),e.jsx(c,{className:"text-center",children:e.jsxs("div",{className:"flex space-x-2 justify-center",children:[e.jsxs(x,{variant:"outline",size:"sm",onClick:()=>T(s),children:[e.jsx(V,{className:"h-4 w-4 mr-2"})," Edit"]}),e.jsxs(x,{variant:"destructive",size:"sm",onClick:()=>C(s.id),children:[e.jsx($,{className:"h-4 w-4 mr-2"})," Delete"]})]})})]},s.id))})]})})})]})})}function ee(){return e.jsx("div",{children:e.jsx(M,{})})}export{ee as default};

import{r as b,j as e,y as t}from"./app-BB_afIc-.js";import{u as C,F as I}from"./index.esm-BFDP6ovz.js";import{L as q}from"./Layout-CsiUY54X.js";import{t as A,V as L,W as D,X as P}from"./navbar-ANKU7EsA.js";import{T as B,a as G,b as w,c as a,d as k,e as n}from"./table-Dxlrwawi.js";import{I as d,B as f}from"./index-BflTKMWf.js";import{C as z}from"./card-CL-H-AKy.js";import{F as m,a as x,b as h,c as u,d as j}from"./form-rfQbMb89.js";import{P as H,T as R}from"./trash-Dc3Kd9gw.js";import"./label-DFwdEFmo.js";function $(){const[y,E]=b.useState([]),[c,N]=b.useState(null),g=C(),{control:l,handleSubmit:F,formState:{errors:o},reset:v,setValue:i}=g,p=async()=>{try{const s=await A();E(s)}catch(s){console.error("Error fetching shops:",s),t.error("Failed to fetch shops")}};b.useEffect(()=>{p()},[]);const T=s=>{N(s),i("name",s.name),i("location",s.address),i("contact_number",s.contact_number),i("gstin_number",s.gstin_number)},_=async s=>{try{const r=await P(s);r.message?(t.success(`${r.message}`),p()):t.error("Failed to delete shop")}catch(r){console.error("Error deleting shop:",r),t.error("Failed to delete shop")}},V=async s=>{var r;try{c?(await L(c.id,s),t.success("Shop updated successfully!")):(await D(s),t.success("Shop added successfully!")),N(null),p(),v({name:"",location:"",contact_number:"",gstin_number:""})}catch(S){console.error("Error adding/editing shop:",((r=S.response)==null?void 0:r.data)||S.message),t.error("Failed to add/edit shop")}};return e.jsx(q,{children:e.jsxs("div",{className:"p-6 flex flex-col items-center w-full",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Vendors"}),e.jsx("div",{className:"max-w-2xl p-6 md:p-8 w-full mx-auto",children:e.jsxs(z,{className:"p-8 shadow-lg rounded-lg bg-white",children:[e.jsx("h3",{className:"text-2xl font-semibold mb-4 text-gray-800",children:c?"Edit Vendor":"Add New Vendor"}),e.jsx(I,{...g,children:e.jsxs("form",{className:"space-y-4",onSubmit:F(V),children:[e.jsx(m,{control:l,name:"name",rules:{required:"Shop Name is required"},render:({field:s})=>{var r;return e.jsxs(x,{children:[e.jsx(h,{children:"Vendor Name"}),e.jsx(u,{children:e.jsx(d,{...s,placeholder:"Enter Vendor name"})}),e.jsx(j,{children:(r=o.name)==null?void 0:r.message})]})}}),e.jsx(m,{control:l,name:"location",rules:{required:"Location is required"},render:({field:s})=>{var r;return e.jsxs(x,{children:[e.jsx(h,{children:"Location"}),e.jsx(u,{children:e.jsx(d,{...s,placeholder:"Enter location"})}),e.jsx(j,{children:(r=o.location)==null?void 0:r.message})]})}}),e.jsx(m,{control:l,name:"contact_number",rules:{required:"Contact Number is required",pattern:{value:/^[0-9]{10}$/,message:"Enter a valid 10-digit number"}},render:({field:s})=>{var r;return e.jsxs(x,{children:[e.jsx(h,{children:"Contact Number"}),e.jsx(u,{children:e.jsx(d,{...s,placeholder:"Enter contact number"})}),e.jsx(j,{children:(r=o.contact_number)==null?void 0:r.message})]})}}),e.jsx(m,{control:l,name:"gstin_number",render:({field:s})=>{var r;return e.jsxs(x,{children:[e.jsx(h,{children:"GSTIN Number (Optional)"}),e.jsx(u,{children:e.jsx(d,{...s,placeholder:"Enter GSTIN number"})}),e.jsx(j,{children:(r=o.gstin_number)==null?void 0:r.message})]})}}),e.jsx(f,{type:"submit",className:"w-full sm:w-auto bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-md transition",children:c?"Update Vendor":"Add Vendor"})]})})]})}),e.jsx("div",{className:"mt-6 w-full flex justify-center",children:e.jsx("div",{className:"w-full max-w-4xl",children:e.jsxs(B,{className:"w-full",children:[e.jsx(G,{children:e.jsxs(w,{children:[e.jsx(a,{className:"text-center",children:"ID"}),e.jsx(a,{className:"text-center",children:"Vendor Name"}),e.jsx(a,{className:"text-center",children:"Contact"}),e.jsx(a,{className:"text-center",children:"GSTIN Number"}),e.jsx(a,{className:"text-center",children:"Address"}),e.jsx(a,{className:"text-center",children:"Actions"})]})}),e.jsx(k,{children:y.map(s=>e.jsxs(w,{children:[e.jsx(n,{className:"text-center",children:s.id}),e.jsx(n,{className:"text-center",children:s.name}),e.jsx(n,{className:"text-center",children:s.contact_number}),e.jsx(n,{className:"text-center",children:s.gstin_number}),e.jsx(n,{className:"text-center",children:s.location}),e.jsx(n,{className:"text-center",children:e.jsxs("div",{className:"flex space-x-2 justify-center",children:[e.jsxs(f,{variant:"outline",size:"sm",onClick:()=>T(s),children:[e.jsx(H,{className:"h-4 w-4 mr-2"})," Edit"]}),e.jsxs(f,{variant:"destructive",size:"sm",onClick:()=>_(s.id),children:[e.jsx(R,{className:"h-4 w-4 mr-2"})," Delete"]})]})})]},s.id))})]})})})]})})}function ee(){return e.jsx("div",{children:e.jsx($,{})})}export{ee as default};

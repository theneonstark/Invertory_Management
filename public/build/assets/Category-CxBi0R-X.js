import{r as c,y as o,j as e}from"./app-By9T3_hT.js";import{u as H,F as z}from"./index.esm-CfDLc69O.js";import{q as G,F as M,G as O,H as V}from"./navbar-CwT8qYnT.js";import{T as $,a as J,b as h,c as i,d as K,e as d}from"./table-M1DGgy18.js";import{I as E,B as m}from"./index-BnX6mjkZ.js";import{C as Q}from"./card-CSknuUnI.js";import{F as I,a as S,b as T,c as D,d as W}from"./form-D4nV-YtK.js";import{P as X,T as Y}from"./trash-BRhYlp0f.js";import{L as Z}from"./Layout-B2cxh-r7.js";import"./label-CFASl-Vv.js";function _(){const u=H({defaultValues:{name:""}}),{control:f,handleSubmit:P,formState:{errors:A},reset:j}=u,[p,L]=c.useState([]),[y,b]=c.useState(null),[N,x]=c.useState(null),[n,w]=c.useState(null);c.useEffect(()=>{g()},[]);const g=async()=>{try{const s=await G();L(s||[])}catch(s){console.error("Error fetching categories:",s),o.error("Failed to load categories")}},U=s=>{w(s),j({name:s.name}),x(s.imageUrl||null)},R=async s=>{var a,r;try{const t=await V(s);t.message?(o.success(`${t.message}`),await g()):o.error("Failed to delete category")}catch(t){console.error("Error deleting category:",t),o.error(((r=(a=t.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to delete category")}},k=s=>{const a=s.target.files[0];if(a){b(a);const r=new FileReader;r.onloadend=()=>{x(r.result)},r.readAsDataURL(a)}},q=async s=>{var a,r,t,v,F;try{const l=new FormData;l.append("name",s.name.trim()),y&&l.append("image",y),n?(await M(n.id,l),o.success("Category updated successfully!")):(await O(l),o.success("Category added successfully!")),C(),await g()}catch(l){console.error("Error adding/updating category:",l),o.error(((r=(a=l.response)==null?void 0:a.data)==null?void 0:r.message)||((F=(v=(t=l.response)==null?void 0:t.data)==null?void 0:v.errors)==null?void 0:F.name)||"Failed to add/update category")}},C=()=>{j({name:""}),b(null),x(null),w(null)},B=()=>{C()};return e.jsxs("div",{className:"p-6 flex flex-col items-center w-full min-h-screen",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Categories"}),e.jsxs(Q,{className:"p-8 shadow-lg rounded-lg bg-white max-w-2xl w-full mb-8",children:[e.jsx("h3",{className:"text-2xl font-semibold mb-6 text-gray-800",children:n?"Edit Category":"Add New Category"}),e.jsx(z,{...u,children:e.jsxs("form",{className:"space-y-6",onSubmit:P(q),children:[e.jsx(I,{control:f,name:"name",rules:{required:"Category Name is required",minLength:{value:2,message:"Category name must be at least 2 characters"}},render:({field:s})=>{var a;return e.jsxs(S,{children:[e.jsx(T,{children:"Category Name"}),e.jsx(D,{children:e.jsx(E,{...s,className:"p-4 border border-gray-300 rounded-md w-full",placeholder:"Enter category name"})}),e.jsx(W,{children:(a=A.name)==null?void 0:a.message})]})}}),e.jsx(I,{control:f,name:"image",render:()=>e.jsxs(S,{children:[e.jsx(T,{children:"Category Image (Optional)"}),e.jsx(D,{children:e.jsx(E,{type:"file",accept:"image/*",onChange:k,className:"p-2 border border-gray-300 rounded-md w-full"})}),N&&e.jsx("div",{className:"mt-4",children:e.jsx("img",{src:N,alt:"Preview",className:"w-full max-w-xs h-auto rounded-md shadow-sm"})})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx(m,{type:"submit",className:"w-full sm:w-auto bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-6 rounded-md",children:n?"Update Category":"Add Category"}),n&&e.jsx(m,{type:"button",onClick:B,className:"w-full sm:w-auto bg-gray-600 hover:bg-gray-700 text-white font-semibold py-2 px-6 rounded-md",children:"Cancel"})]})]})})]}),e.jsx("div",{className:"w-full max-w-4xl",children:e.jsxs($,{className:"w-full border rounded-lg",children:[e.jsx(J,{children:e.jsxs(h,{className:"bg-gray-50",children:[e.jsx(i,{className:"text-center font-semibold",children:"ID"}),e.jsx(i,{className:"text-center font-semibold",children:"Name"}),e.jsx(i,{className:"text-center font-semibold",children:"Image"}),e.jsx(i,{className:"text-center font-semibold",children:"Actions"})]})}),e.jsx(K,{children:p.length>0?p.map(s=>e.jsxs(h,{className:"hover:bg-gray-100",children:[e.jsx(d,{className:"text-center",children:s.id}),e.jsx(d,{className:"text-center",children:s.name}),e.jsx(d,{className:"text-center",children:s.imageUrl?e.jsx("img",{src:s.imageUrl,alt:s.name,className:"w-12 h-12 object-cover rounded-md mx-auto"}):"N/A"}),e.jsx(d,{className:"text-center",children:e.jsxs("div",{className:"flex space-x-2 justify-center",children:[e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>U(s),className:"flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4"})," Edit"]}),e.jsxs(m,{variant:"destructive",size:"sm",onClick:()=>R(s.id),className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4"})," Delete"]})]})})]},s.id)):e.jsx(h,{children:e.jsx(d,{colSpan:4,className:"text-center py-4 text-gray-500",children:"No categories available"})})})]})})]})}function ie(){return e.jsx(Z,{children:e.jsx(_,{})})}export{ie as default};
